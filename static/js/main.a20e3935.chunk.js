(this["webpackJsonpfullstack-apollo-react-boilerplate-project"]=this["webpackJsonpfullstack-apollo-react-boilerplate-project"]||[]).push([[0],{126:function(e,t,a){"use strict";a.r(t);var n=a(30),r=a(0),o=a.n(r),l=a(13),s=a.n(l),c=a(17),i=a(61),m=a(9),u=a(84),p=a(79),h=a(180),d=a(83),g=a(178),E=a(184),f=a(177),b=a(170),v=a(174),w=a(171),y=a(172),S=a(173),k=a(181);var x=a(80),C=a.n(x)()({basename:"/qrr-frontend"});const j=e=>{localStorage.removeItem("token"),e.resetStore(),C.push("/signin")};var O=()=>o.a.createElement(c.ApolloConsumer,null,e=>o.a.createElement(k.a,{color:"inherit",type:"button",onClick:()=>j(e)},"Sign Out"));const $=Object(b.a)(e=>({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})),q=({session:e})=>{const t=$();return o.a.createElement("div",{className:t},o.a.createElement(w.a,null,o.a.createElement(y.a,null,o.a.createElement(S.a,{variant:"h6",className:t.title},"QR^2"),o.a.createElement(O,null))),o.a.createElement(y.a,null))},I=()=>{const e=$();return o.a.createElement("div",{className:e},o.a.createElement(w.a,null,o.a.createElement(y.a,null,o.a.createElement(S.a,{variant:"h6",className:e.title},"QR^2"),o.a.createElement(S.a,null,o.a.createElement(v.a,{to:"/signin"},o.a.createElement(k.a,{color:"primary"},"Sign In"))))),o.a.createElement(y.a,null))};var N=({session:e})=>o.a.createElement("div",null,e&&e.me?o.a.createElement(q,{session:e}):o.a.createElement(I,null)),U=a(22),A=a(23),T=a.n(A);function Q(){const e=Object(U.a)(["\n  {\n    me {\n      id\n      username\n      email\n      role\n    }\n  }\n"]);return Q=function(){return e},e}const P=T()(Q());var D=e=>t=>o.a.createElement(c.Query,{query:P},({data:a,refetch:n})=>o.a.createElement(e,Object.assign({},t,{session:a,refetch:n})));function M(){const e=Object(U.a)(["\n  query {\n    recipes {\n        id\n        name\n        author{\n          username\n        }\n        ingredients {\n          qty\n          item {\n            name\n          }\n        }\n        instructions {\n          text\n          ingredients {\n            item {\n              name\n            }\n          }\n        }\n      }\n  }\n"]);return M=function(){return e},e}const R=T()(M()),F=e=>o.a.createElement(c.Query,{query:R},e=>{const t=e.data;return console.log({data:t,props:e}),o.a.createElement("div",null,t.recipes&&t.recipes.map(e=>o.a.createElement("li",{key:e.id},e.name)))});var G=D(({session:e})=>o.a.createElement("div",null,o.a.createElement("h2",null,"Recipes"),o.a.createElement(F,null))),B=a(38),J=a.n(B),L=a(51),H=a(183);var W=({error:e})=>o.a.createElement("div",null,o.a.createElement("small",null,e.message));function z(){const e=Object(U.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    signUp(username: $username, email: $email, password: $password) {\n      token\n    }\n  }\n"]);return z=function(){return e},e}const K=T()(z()),V={username:"",email:"",password:"",passwordConfirmation:""};class X extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},V),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(L.a)(J.a.mark((function e({data:a}){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},V)),localStorage.setItem("token",a.signUp.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.username,a=e.email,n=e.password,r=e.passwordConfirmation,l=n!==r||""===n||""===a||""===t;return o.a.createElement(c.Mutation,{mutation:K,variables:{username:t,email:a,password:n}},(e,{data:s,loading:c,error:i})=>o.a.createElement("form",{onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),o.a.createElement("input",{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email Address"}),o.a.createElement("input",{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),o.a.createElement("input",{name:"passwordConfirmation",value:r,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),o.a.createElement("button",{disabled:l||c,type:"submit"},"Sign Up"),i&&o.a.createElement(W,{error:i})))}}const Y=()=>o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(v.a,{to:"/signup"},"Sign Up"));var Z=Object(H.a)(({history:e,refetch:t})=>o.a.createElement("div",null,o.a.createElement("h1",null,"SignUp"),o.a.createElement(X,{history:e,refetch:t}))),_=a(175),ee=a(176),te=a(5),ae=a(179);function ne(){const e=Object(U.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return ne=function(){return e},e}const re=T()(ne()),oe={login:"",password:""};class le extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},oe),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(L.a)(J.a.mark((function e({data:a}){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},oe)),localStorage.setItem("token",a.signIn.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.login,a=e.password,n=this.props.classes,r=""===a||""===t;return o.a.createElement(c.Mutation,{mutation:re,variables:{login:t,password:a}},(e,{data:l,loading:s,error:c})=>o.a.createElement("form",{className:n.root,onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("div",null,o.a.createElement(ae.a,{required:!0,id:"login-filled-required",label:"Email Or Username",variant:"outlined",value:t,onChange:this.onChange,placeholder:"Email or Username",name:"login"}),o.a.createElement(ae.a,{variant:"outlined",required:!0,id:"pw-filled-required",name:"password",value:a,onChange:this.onChange,type:"password",placeholder:"Password"})),o.a.createElement(k.a,{disabled:r||s,type:"submit"},"Sign In"),c&&o.a.createElement(W,{error:c})))}}var se=Object(te.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"100%"}}}),{withTheme:!0})(le);function ce(){const e=Object(U.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return ce=function(){return e},e}T()(ce());var ie=Object(H.a)(({history:e,refetch:t})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,null),o.a.createElement(ee.a,{maxWidth:"sm"},o.a.createElement("h1",null,"SignIn"),o.a.createElement(se,{history:e,refetch:t}),o.a.createElement(Y,null)))),me=a(182);var ue=e=>t=>a=>o.a.createElement(c.Query,{query:P},({data:n,networkStatus:r})=>r<7?null:e(n)?o.a.createElement(t,a):o.a.createElement(me.a,{to:"/signin"}));var pe=ue(e=>e&&e.me)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Account Page")));var he=ue(e=>e&&e.me&&"ADMIN"===e.me.role)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Admin Page")));var de=D(({session:e,refetch:t})=>o.a.createElement(E.a,{history:C,basename:"/qrr-frontend"},o.a.createElement("div",null,o.a.createElement(N,{session:e}),o.a.createElement(f.a,{exact:!0,path:"/",component:()=>o.a.createElement(G,null)}),o.a.createElement(f.a,{exact:!0,path:"/signup",component:()=>o.a.createElement(Z,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/signin",component:()=>o.a.createElement(ie,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/account",component:()=>o.a.createElement(pe,null)}),o.a.createElement(f.a,{exact:!0,path:"/admin",component:()=>o.a.createElement(he,null)}))));const ge=new u.a({uri:"https://quarantine-recipe-repository.appspot.com/graphql"}),Ee=new m.a((e,t)=>(e.setContext(({headers:e={}})=>{const t=localStorage.getItem("token");return t&&(e=Object(n.a)({},e,{"x-token":t})),{headers:e}}),t(e))),fe=Object(p.a)(({graphQLErrors:e,networkError:t})=>{e&&e.forEach(({message:e,locations:t,path:a})=>{console.log("GraphQL error",e),"UNAUTHENTICATED"===e&&j(we)}),t&&(console.log("Network error",t),401===t.statusCode&&j(we))}),be=m.a.from([Ee,fe,ge]),ve=new h.a,we=new i.a({link:be,cache:ve}),ye=Object(d.a)({palette:{common:{black:"#000",white:"#fff"},background:{paper:"#fff",default:"#fafafa"},primary:{light:"rgba(116, 195, 30, 1)",main:"rgba(87, 161, 3, 1)",dark:"rgba(65, 117, 5, 1)",contrastText:"#fff"},secondary:{light:"rgba(74, 144, 226, 1)",main:"rgba(9, 96, 198, 1)",dark:"rgba(5, 61, 128, 1)",contrastText:"#fff"},error:{light:"#e57373",main:"#f44336",dark:"#d32f2f",contrastText:"#fff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"}}});s.a.render(o.a.createElement(c.ApolloProvider,{client:we},o.a.createElement(g.a,{theme:ye},o.a.createElement(de,null))),document.getElementById("root"))},92:function(e,t,a){e.exports=a(126)}},[[92,1,2]]]);
//# sourceMappingURL=main.a20e3935.chunk.js.map