(this["webpackJsonpfullstack-apollo-react-boilerplate-project"]=this["webpackJsonpfullstack-apollo-react-boilerplate-project"]||[]).push([[0],{126:function(e,t,a){"use strict";a.r(t);var n=a(30),r=a(0),o=a.n(r),l=a(13),s=a.n(l),c=a(17),i=a(61),m=a(9),u=a(84),p=a(79),h=a(180),d=a(83),g=a(178),E=a(184),f=a(177),b=a(170),v=a(174),w=a(171),S=a(172),y=a(173),k=a(181);var x=a(80),C=a.n(x)()({basename:"/qrr-frontend"});const j=e=>{localStorage.removeItem("token"),e.resetStore(),C.push("/signin")};var O=()=>o.a.createElement(c.ApolloConsumer,null,e=>o.a.createElement(k.a,{color:"inherit",type:"button",onClick:()=>j(e)},"Sign Out"));const $=Object(b.a)(e=>({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})),I=({session:e})=>{const t=$();return o.a.createElement("div",{className:t},o.a.createElement(w.a,null,o.a.createElement(S.a,null,o.a.createElement(y.a,{variant:"h6",className:t.title},"QR^2"),o.a.createElement(O,null))),o.a.createElement(S.a,null))},q=()=>{const e=$();return o.a.createElement("div",{className:e},o.a.createElement(w.a,null,o.a.createElement(S.a,null,o.a.createElement(y.a,{variant:"h6",className:e.title},"QR^2"),o.a.createElement(y.a,null,o.a.createElement(v.a,{to:"/signin"},o.a.createElement(k.a,{color:"primary.contrastText"},"Sign In"))))),o.a.createElement(S.a,null))};var N=({session:e})=>o.a.createElement("div",null,e&&e.me?o.a.createElement(I,{session:e}):o.a.createElement(q,null)),T=a(26),U=a(27),A=a.n(U);function P(){const e=Object(T.a)(["\n  {\n    me {\n      id\n      username\n      email\n      role\n    }\n  }\n"]);return P=function(){return e},e}const Q=A()(P());var D=e=>t=>o.a.createElement(c.Query,{query:Q},({data:a,refetch:n})=>o.a.createElement(e,Object.assign({},t,{session:a,refetch:n})));var M=D(({session:e})=>o.a.createElement("div",null,o.a.createElement("h2",null,"Landing Page"))),F=a(38),G=a.n(F),L=a(51),R=a(183);var B=({error:e})=>o.a.createElement("div",null,o.a.createElement("small",null,e.message));function J(){const e=Object(T.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    signUp(username: $username, email: $email, password: $password) {\n      token\n    }\n  }\n"]);return J=function(){return e},e}const H=A()(J()),W={username:"",email:"",password:"",passwordConfirmation:""};class z extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},W),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(L.a)(G.a.mark((function e({data:a}){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},W)),localStorage.setItem("token",a.signUp.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.username,a=e.email,n=e.password,r=e.passwordConfirmation,l=n!==r||""===n||""===a||""===t;return o.a.createElement(c.Mutation,{mutation:H,variables:{username:t,email:a,password:n}},(e,{data:s,loading:c,error:i})=>o.a.createElement("form",{onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),o.a.createElement("input",{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email Address"}),o.a.createElement("input",{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),o.a.createElement("input",{name:"passwordConfirmation",value:r,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),o.a.createElement("button",{disabled:l||c,type:"submit"},"Sign Up"),i&&o.a.createElement(B,{error:i})))}}const K=()=>o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(v.a,{to:"/signup"},"Sign Up"));var V=Object(R.a)(({history:e,refetch:t})=>o.a.createElement("div",null,o.a.createElement("h1",null,"SignUp"),o.a.createElement(z,{history:e,refetch:t}))),X=a(175),Y=a(176),Z=a(5),_=a(179);function ee(){const e=Object(T.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return ee=function(){return e},e}const te=A()(ee()),ae={login:"",password:""};class ne extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},ae),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(L.a)(G.a.mark((function e({data:a}){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},ae)),localStorage.setItem("token",a.signIn.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.login,a=e.password,n=this.props.classes,r=""===a||""===t;return o.a.createElement(c.Mutation,{mutation:te,variables:{login:t,password:a}},(e,{data:l,loading:s,error:c})=>o.a.createElement("form",{className:n.root,onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("div",null,o.a.createElement(_.a,{required:!0,id:"login-filled-required",label:"Email Or Username",variant:"outlined",value:t,onChange:this.onChange,placeholder:"Email or Username",name:"login"}),o.a.createElement(_.a,{variant:"outlined",required:!0,id:"pw-filled-required",name:"password",value:a,onChange:this.onChange,type:"password",placeholder:"Password"})),o.a.createElement(k.a,{disabled:r||s,type:"submit"},"Sign In"),c&&o.a.createElement(B,{error:c})))}}var re=Object(Z.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"100%"}}}),{withTheme:!0})(ne);function oe(){const e=Object(T.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return oe=function(){return e},e}A()(oe());var le=Object(R.a)(({history:e,refetch:t})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(X.a,null),o.a.createElement(Y.a,{maxWidth:"sm"},o.a.createElement("h1",null,"SignIn"),o.a.createElement(re,{history:e,refetch:t}),o.a.createElement(K,null)))),se=a(182);var ce=e=>t=>a=>o.a.createElement(c.Query,{query:Q},({data:n,networkStatus:r})=>r<7?null:e(n)?o.a.createElement(t,a):o.a.createElement(se.a,{to:"/signin"}));var ie=ce(e=>e&&e.me)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Account Page")));var me=ce(e=>e&&e.me&&"ADMIN"===e.me.role)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Admin Page")));var ue=D(({session:e,refetch:t})=>o.a.createElement(E.a,{history:C,basename:"/qrr-frontend"},o.a.createElement("div",null,o.a.createElement(N,{session:e}),o.a.createElement(f.a,{exact:!0,path:"/",component:()=>o.a.createElement(M,null)}),o.a.createElement(f.a,{exact:!0,path:"/signup",component:()=>o.a.createElement(V,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/signin",component:()=>o.a.createElement(le,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/account",component:()=>o.a.createElement(ie,null)}),o.a.createElement(f.a,{exact:!0,path:"/admin",component:()=>o.a.createElement(me,null)}))));const pe=new u.a({uri:"https://quarantine-recipe-repository.appspot.com/graphql"}),he=new m.a((e,t)=>(e.setContext(({headers:e={}})=>{const t=localStorage.getItem("token");return t&&(e=Object(n.a)({},e,{"x-token":t})),{headers:e}}),t(e))),de=Object(p.a)(({graphQLErrors:e,networkError:t})=>{e&&e.forEach(({message:e,locations:t,path:a})=>{console.log("GraphQL error",e),"UNAUTHENTICATED"===e&&j(fe)}),t&&(console.log("Network error",t),401===t.statusCode&&j(fe))}),ge=m.a.from([he,de,pe]),Ee=new h.a,fe=new i.a({link:ge,cache:Ee}),be=Object(d.a)({palette:{common:{black:"#000",white:"#fff"},background:{paper:"#fff",default:"#fafafa"},primary:{light:"rgba(116, 195, 30, 1)",main:"rgba(87, 161, 3, 1)",dark:"rgba(65, 117, 5, 1)",contrastText:"#fff"},secondary:{light:"rgba(74, 144, 226, 1)",main:"rgba(9, 96, 198, 1)",dark:"rgba(5, 61, 128, 1)",contrastText:"#fff"},error:{light:"#e57373",main:"#f44336",dark:"#d32f2f",contrastText:"#fff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"}}});s.a.render(o.a.createElement(c.ApolloProvider,{client:fe},o.a.createElement(g.a,{theme:be},o.a.createElement(ue,null))),document.getElementById("root"))},92:function(e,t,a){e.exports=a(126)}},[[92,1,2]]]);
//# sourceMappingURL=main.b25e5d21.chunk.js.map