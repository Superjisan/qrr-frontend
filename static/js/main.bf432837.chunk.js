(this["webpackJsonpfullstack-apollo-react-boilerplate-project"]=this["webpackJsonpfullstack-apollo-react-boilerplate-project"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var a=n(31),r=n(0),o=n.n(r),s=n(13),l=n.n(s),c=n(15),i=n(62),m=n(9),u=n(86),p=n(81),d=n(180),h=n(85),g=n(178),E=n(184),f=n(177),b=n(170),v=n(174),w=n(171),S=n(172),y=n(173),k=n(181);var x=n(82),C=n.n(x)()({basename:"/qrr-frontend"});const j=e=>{localStorage.removeItem("token"),e.resetStore(),C.push("/signin")};var O=()=>o.a.createElement(c.ApolloConsumer,null,e=>o.a.createElement(k.a,{color:"primary.light",onClick:()=>j(e)},"Sign Out"));const I=Object(b.a)(e=>({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})),T=({session:e})=>{const t=I();return o.a.createElement("div",{className:t},o.a.createElement(w.a,null,o.a.createElement(S.a,null,o.a.createElement(y.a,{variant:"h6",className:t.title},"QR^2"),o.a.createElement(y.a,null,o.a.createElement(O,null)))),o.a.createElement(S.a,null))},$=()=>{const e=I();return o.a.createElement("div",{className:e},o.a.createElement(w.a,null,o.a.createElement(S.a,null,o.a.createElement(y.a,{variant:"h6",className:e.title},"QR^2"),o.a.createElement(y.a,null,o.a.createElement(v.a,{to:"/signin"},o.a.createElement(k.a,{color:"contrastText"},"Sign In"))))),o.a.createElement(S.a,null))};var q=({session:e})=>o.a.createElement("div",null,e&&e.me?o.a.createElement(T,{session:e}):o.a.createElement($,null)),N=n(19),A=n(20),R=n.n(A);function U(){const e=Object(N.a)(["\n  {\n    me {\n      id\n      username\n      email\n      role\n    }\n  }\n"]);return U=function(){return e},e}const Q=R()(U());var B=e=>t=>o.a.createElement(c.Query,{query:Q},({data:n,refetch:a})=>o.a.createElement(e,Object.assign({},t,{session:n,refetch:a}))),D=n(130),M=n(5);function P(){const e=Object(N.a)(["\n  query {\n    recipes {\n      id\n      name\n      author {\n        username\n      }\n      ingredients {\n        qty\n        item {\n          name\n        }\n      }\n      instructions {\n        text\n        ingredients {\n          item {\n            name\n          }\n        }\n      }\n    }\n  }\n"]);return P=function(){return e},e}const F=R()(P());var G=Object(M.a)(e=>({list:{width:"100%",backgroundColor:e.palette.background.paper,paddingTop:0},inline:{display:"inline"},paperRoot:{paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),marginTop:e.spacing(2),marginBottom:e.spacing(2),widht:"100%"},fontIcon:{float:"right",marginRight:5,cursor:"pointer"},paragraph:{marginTop:10},listItem:{paddingTop:0,paddingBottom:0},button:{width:"100%"}}))(e=>{const t=e.classes,n=e.session;return o.a.createElement(c.Query,{query:F},e=>{const a=e.data;return console.log({data:a}),o.a.createElement("div",null,n&&n.me&&o.a.createElement(v.a,{to:"/add-recipe"},o.a.createElement(k.a,{className:t.button,variant:"contained",color:"secondary"},"Add Recipe")),a&&a.recipes&&a.recipes.map(e=>o.a.createElement(o.a.Fragment,null,o.a.createElement(D.a,{className:t.paperRoot,key:e.id},o.a.createElement(y.a,{variant:"h5"},e.name),o.a.createElement(y.a,null,"# of Ingredients: ",e.ingredients.length),o.a.createElement(y.a,null,"# of Instructions:"," ",e.instructions.length),o.a.createElement(y.a,null,"Author: ",e.author.username)))))})});var L=B(({session:e})=>o.a.createElement("div",null,o.a.createElement("h2",null,"Recipes"),o.a.createElement(G,{session:e}))),J=n(27),H=n.n(J),W=n(38),Y=n(183);var z=({error:e})=>o.a.createElement("div",null,o.a.createElement("small",null,e.message));function K(){const e=Object(N.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    signUp(username: $username, email: $email, password: $password) {\n      token\n    }\n  }\n"]);return K=function(){return e},e}const V=R()(K()),X={username:"",email:"",password:"",passwordConfirmation:""};class Z extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(a.a)({},X),this.onChange=e=>{const t=e.target,n=t.name,a=t.value;this.setState({[n]:a})},this.onSubmit=(e,n)=>{n().then(function(){var e=Object(W.a)(H.a.mark((function e({data:n}){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(a.a)({},X)),localStorage.setItem("token",n.signUp.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.username,n=e.email,a=e.password,r=e.passwordConfirmation,s=a!==r||""===a||""===n||""===t;return o.a.createElement(c.Mutation,{mutation:V,variables:{username:t,email:n,password:a}},(e,{data:l,loading:c,error:i})=>o.a.createElement("form",{onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),o.a.createElement("input",{name:"email",value:n,onChange:this.onChange,type:"text",placeholder:"Email Address"}),o.a.createElement("input",{name:"password",value:a,onChange:this.onChange,type:"password",placeholder:"Password"}),o.a.createElement("input",{name:"passwordConfirmation",value:r,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),o.a.createElement("button",{disabled:s||c,type:"submit"},"Sign Up"),i&&o.a.createElement(z,{error:i})))}}const _=()=>o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(v.a,{to:"/signup"},"Sign Up"));var ee=Object(Y.a)(({history:e,refetch:t})=>o.a.createElement("div",null,o.a.createElement("h1",null,"SignUp"),o.a.createElement(Z,{history:e,refetch:t}))),te=n(175),ne=n(176),ae=n(179);function re(){const e=Object(N.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return re=function(){return e},e}const oe=R()(re()),se={login:"",password:""};class le extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(a.a)({},se),this.onChange=e=>{const t=e.target,n=t.name,a=t.value;this.setState({[n]:a})},this.onSubmit=(e,n)=>{n().then(function(){var e=Object(W.a)(H.a.mark((function e({data:n}){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(a.a)({},se)),localStorage.setItem("token",n.signIn.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.login,n=e.password,a=this.props.classes,r=""===n||""===t;return o.a.createElement(c.Mutation,{mutation:oe,variables:{login:t,password:n}},(e,{data:s,loading:l,error:c})=>o.a.createElement("form",{className:a.root,onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("div",null,o.a.createElement(ae.a,{required:!0,id:"login-filled-required",label:"Email Or Username",variant:"outlined",value:t,onChange:this.onChange,placeholder:"Email or Username",name:"login"}),o.a.createElement(ae.a,{variant:"outlined",required:!0,id:"pw-filled-required",name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"})),o.a.createElement(k.a,{disabled:r||l,type:"submit"},"Sign In"),c&&o.a.createElement(z,{error:c})))}}var ce=Object(M.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"100%"}}}),{withTheme:!0})(le);function ie(){const e=Object(N.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return ie=function(){return e},e}R()(ie());var me=Object(Y.a)(({history:e,refetch:t})=>o.a.createElement(o.a.Fragment,null,o.a.createElement(te.a,null),o.a.createElement(ne.a,{maxWidth:"sm"},o.a.createElement("h1",null,"SignIn"),o.a.createElement(ce,{history:e,refetch:t}),o.a.createElement(_,null)))),ue=n(182);var pe=e=>t=>n=>o.a.createElement(c.Query,{query:Q},({data:a,networkStatus:r})=>r<7?null:e(a)?o.a.createElement(t,n):o.a.createElement(ue.a,{to:"/signin"}));var de=pe(e=>e&&e.me)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Account Page")));var he=pe(e=>e&&e.me&&"ADMIN"===e.me.role)(()=>o.a.createElement("div",null,o.a.createElement("h1",null,"Admin Page")));function ge(){const e=Object(N.a)(["\n  mutation($name: String!) {\n    addRecipe(name: $name) {\n      id\n      name\n      author {\n        username\n      }\n    }\n  }\n"]);return ge=function(){return e},e}const Ee=R()(ge());class fe extends r.Component{constructor(...e){var t;super(...e),t=this,this.state={name:""},this.onChange=e=>{const t=e.target,n=t.name,a=t.value;this.setState({[n]:a})},this.onSubmit=function(){var e=Object(W.a)(H.a.mark((function e(n,a){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,a();case 4:t.setState({name:""}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()}render(){const e=this.props.session,t=this.state.name;return o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a,{to:"/"},"Back To Recipes"),e&&e.me?o.a.createElement(c.Mutation,{mutation:Ee,variables:{name:t}},(e,n)=>{n.data,n.loading;const a=n.error;return o.a.createElement("form",{onSubmit:t=>this.onSubmit(t,e)},o.a.createElement("input",{name:"name",value:t,onChange:this.onChange}),o.a.createElement("button",{type:"submit"},"Send"),a&&o.a.createElement(z,{error:a}))}):"Not Allowed To Add Recipe, You Must Sign In")}}var be=B(fe);var ve=B(({session:e,refetch:t})=>o.a.createElement(E.a,{history:C,basename:"/qrr-frontend"},o.a.createElement("div",null,o.a.createElement(q,{session:e}),o.a.createElement(f.a,{exact:!0,path:"/",component:()=>o.a.createElement(L,null)}),o.a.createElement(f.a,{exact:!0,path:"/signup",component:()=>o.a.createElement(ee,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/signin",component:()=>o.a.createElement(me,{refetch:t})}),o.a.createElement(f.a,{exact:!0,path:"/account",component:()=>o.a.createElement(de,null)}),o.a.createElement(f.a,{exact:!0,path:"/admin",component:()=>o.a.createElement(he,null)}),o.a.createElement(f.a,{exact:!0,path:"/add-recipe",component:()=>o.a.createElement(be,null)}))));const we=new u.a({uri:"https://quarantine-recipe-repository.appspot.com/graphql"}),Se=new m.a((e,t)=>(e.setContext(({headers:e={}})=>{const t=localStorage.getItem("token");return t&&(e=Object(a.a)({},e,{"x-token":t})),{headers:e}}),t(e))),ye=Object(p.a)(({graphQLErrors:e,networkError:t})=>{e&&e.forEach(({message:e,locations:t,path:n})=>{console.log("GraphQL error",e),"UNAUTHENTICATED"===e&&j(Ce)}),t&&(console.log("Network error",t),401===t.statusCode&&j(Ce))}),ke=m.a.from([Se,ye,we]),xe=new d.a,Ce=new i.a({link:ke,cache:xe}),je=Object(h.a)({palette:{common:{black:"#000",white:"#fff"},background:{paper:"#fff",default:"#fafafa"},primary:{light:"rgba(116, 195, 30, 1)",main:"rgba(87, 161, 3, 1)",dark:"rgba(65, 117, 5, 1)",contrastText:"#fff"},secondary:{light:"rgba(74, 144, 226, 1)",main:"rgba(9, 96, 198, 1)",dark:"rgba(5, 61, 128, 1)",contrastText:"#fff"},error:{light:"#e57373",main:"#f44336",dark:"#d32f2f",contrastText:"#fff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"}}});l.a.render(o.a.createElement(c.ApolloProvider,{client:Ce},o.a.createElement(g.a,{theme:je},o.a.createElement(ve,null))),document.getElementById("root"))},92:function(e,t,n){e.exports=n(126)}},[[92,1,2]]]);
//# sourceMappingURL=main.bf432837.chunk.js.map