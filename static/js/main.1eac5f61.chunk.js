(this["webpackJsonpfullstack-apollo-react-boilerplate-project"]=this["webpackJsonpfullstack-apollo-react-boilerplate-project"]||[]).push([[0],{126:function(e,t,a){"use strict";a.r(t);var n=a(30),r=a(0),l=a.n(r),o=a(13),s=a.n(o),c=a(17),i=a(61),m=a(9),u=a(84),p=a(79),h=a(180),d=a(83),g=a(178),E=a(184),f=a(177),b=a(170),v=a(171),w=a(172),S=a(173),y=a(181);var k=a(80),x=a.n(k)()();const C=e=>{localStorage.removeItem("token"),e.resetStore(),x.push("/signin")};var j=()=>l.a.createElement(c.ApolloConsumer,null,e=>l.a.createElement(y.a,{color:"inherit",type:"button",onClick:()=>C(e)},"Sign Out"));const O=Object(b.a)(e=>({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})),$=({session:e})=>{const t=O();return l.a.createElement("div",{className:t},l.a.createElement(v.a,null,l.a.createElement(w.a,null,l.a.createElement(S.a,{variant:"h6",className:t.title},"QR^2"),l.a.createElement(j,null))),l.a.createElement(w.a,null))},I=()=>{const e=O();return l.a.createElement("div",{className:e},l.a.createElement(v.a,null,l.a.createElement(w.a,null,l.a.createElement(S.a,{variant:"h6",className:e.title},"QR^2"),l.a.createElement(S.a,null,l.a.createElement(y.a,{color:"primary.contrastText",href:"".concat("/signin")},"Sign In")))),l.a.createElement(w.a,null))};var N=({session:e})=>l.a.createElement("div",null,e&&e.me?l.a.createElement($,{session:e}):l.a.createElement(I,null)),T=a(26),U=a(27),A=a.n(U);function q(){const e=Object(T.a)(["\n  {\n    me {\n      id\n      username\n      email\n      role\n    }\n  }\n"]);return q=function(){return e},e}const P=A()(q());var Q=e=>t=>l.a.createElement(c.Query,{query:P},({data:a,refetch:n})=>l.a.createElement(e,Object.assign({},t,{session:a,refetch:n})));var D=Q(({session:e})=>l.a.createElement("div",null,l.a.createElement("h2",null,"Landing Page"))),M=a(38),F=a.n(M),G=a(50),L=a(174),R=a(183);var B=({error:e})=>l.a.createElement("div",null,l.a.createElement("small",null,e.message));function J(){const e=Object(T.a)(["\n  mutation($username: String!, $email: String!, $password: String!) {\n    signUp(username: $username, email: $email, password: $password) {\n      token\n    }\n  }\n"]);return J=function(){return e},e}const H=A()(J()),W={username:"",email:"",password:"",passwordConfirmation:""};class z extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},W),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(G.a)(F.a.mark((function e({data:a}){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},W)),localStorage.setItem("token",a.signUp.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.username,a=e.email,n=e.password,r=e.passwordConfirmation,o=n!==r||""===n||""===a||""===t;return l.a.createElement(c.Mutation,{mutation:H,variables:{username:t,email:a,password:n}},(e,{data:s,loading:c,error:i})=>l.a.createElement("form",{onSubmit:t=>this.onSubmit(t,e)},l.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),l.a.createElement("input",{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email Address"}),l.a.createElement("input",{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),l.a.createElement("input",{name:"passwordConfirmation",value:r,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),l.a.createElement("button",{disabled:o||c,type:"submit"},"Sign Up"),i&&l.a.createElement(B,{error:i})))}}const K=()=>l.a.createElement("p",null,"Don't have an account? ",l.a.createElement(L.a,{to:"/signup"},"Sign Up"));var V=Object(R.a)(({history:e,refetch:t})=>l.a.createElement("div",null,l.a.createElement("h1",null,"SignUp"),l.a.createElement(z,{history:e,refetch:t}))),X=a(175),Y=a(176),Z=a(5),_=a(179);function ee(){const e=Object(T.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return ee=function(){return e},e}const te=A()(ee()),ae={login:"",password:""};class ne extends r.Component{constructor(...e){var t;super(...e),t=this,this.state=Object(n.a)({},ae),this.onChange=e=>{const t=e.target,a=t.name,n=t.value;this.setState({[a]:n})},this.onSubmit=(e,a)=>{a().then(function(){var e=Object(G.a)(F.a.mark((function e({data:a}){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState(Object(n.a)({},ae)),localStorage.setItem("token",a.signIn.token),e.next=4,t.props.refetch();case 4:t.props.history.push("/");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.preventDefault()}}render(){const e=this.state,t=e.login,a=e.password,n=this.props.classes,r=""===a||""===t;return l.a.createElement(c.Mutation,{mutation:te,variables:{login:t,password:a}},(e,{data:o,loading:s,error:c})=>l.a.createElement("form",{className:n.root,onSubmit:t=>this.onSubmit(t,e)},l.a.createElement("div",null,l.a.createElement(_.a,{required:!0,id:"login-filled-required",label:"Email Or Username",variant:"outlined",value:t,onChange:this.onChange,placeholder:"Email or Username",name:"login"}),l.a.createElement(_.a,{variant:"outlined",required:!0,id:"pw-filled-required",name:"password",value:a,onChange:this.onChange,type:"password",placeholder:"Password"})),l.a.createElement(y.a,{disabled:r||s,type:"submit"},"Sign In"),c&&l.a.createElement(B,{error:c})))}}var re=Object(Z.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"100%"}}}),{withTheme:!0})(ne);function le(){const e=Object(T.a)(["\n  mutation($login: String!, $password: String!) {\n    signIn(login: $login, password: $password) {\n      token\n    }\n  }\n"]);return le=function(){return e},e}A()(le());var oe=Object(R.a)(({history:e,refetch:t})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(X.a,null),l.a.createElement(Y.a,{maxWidth:"sm"},l.a.createElement("h1",null,"SignIn"),l.a.createElement(re,{history:e,refetch:t}),l.a.createElement(K,null)))),se=a(182);var ce=e=>t=>a=>l.a.createElement(c.Query,{query:P},({data:n,networkStatus:r})=>r<7?null:e(n)?l.a.createElement(t,a):l.a.createElement(se.a,{to:"/signin"}));var ie=ce(e=>e&&e.me)(()=>l.a.createElement("div",null,l.a.createElement("h1",null,"Account Page")));var me=ce(e=>e&&e.me&&"ADMIN"===e.me.role)(()=>l.a.createElement("div",null,l.a.createElement("h1",null,"Admin Page")));var ue=Q(({session:e,refetch:t})=>l.a.createElement(E.a,{history:x},l.a.createElement("div",null,l.a.createElement(N,{session:e}),l.a.createElement(f.a,{exact:!0,path:"/",component:()=>l.a.createElement(D,null)}),l.a.createElement(f.a,{exact:!0,path:"/signup",component:()=>l.a.createElement(V,{refetch:t})}),l.a.createElement(f.a,{exact:!0,path:"/signin",component:()=>l.a.createElement(oe,{refetch:t})}),l.a.createElement(f.a,{exact:!0,path:"/account",component:()=>l.a.createElement(ie,null)}),l.a.createElement(f.a,{exact:!0,path:"/admin",component:()=>l.a.createElement(me,null)}))));const pe=new u.a({uri:"http://localhost:8000/graphql"}),he=new m.a((e,t)=>(e.setContext(({headers:e={}})=>{const t=localStorage.getItem("token");return t&&(e=Object(n.a)({},e,{"x-token":t})),{headers:e}}),t(e))),de=Object(p.a)(({graphQLErrors:e,networkError:t})=>{e&&e.forEach(({message:e,locations:t,path:a})=>{console.log("GraphQL error",e),"UNAUTHENTICATED"===e&&C(fe)}),t&&(console.log("Network error",t),401===t.statusCode&&C(fe))}),ge=m.a.from([he,de,pe]),Ee=new h.a,fe=new i.a({link:ge,cache:Ee}),be=Object(d.a)({palette:{common:{black:"#000",white:"#fff"},background:{paper:"#fff",default:"#fafafa"},primary:{light:"rgba(116, 195, 30, 1)",main:"rgba(87, 161, 3, 1)",dark:"rgba(65, 117, 5, 1)",contrastText:"#fff"},secondary:{light:"rgba(74, 144, 226, 1)",main:"rgba(9, 96, 198, 1)",dark:"rgba(5, 61, 128, 1)",contrastText:"#fff"},error:{light:"#e57373",main:"#f44336",dark:"#d32f2f",contrastText:"#fff"},text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"}}});s.a.render(l.a.createElement(c.ApolloProvider,{client:fe},l.a.createElement(g.a,{theme:be},l.a.createElement(ue,null))),document.getElementById("root"))},92:function(e,t,a){e.exports=a(126)}},[[92,1,2]]]);
//# sourceMappingURL=main.1eac5f61.chunk.js.map